<%inherit file="base.html"/>

<div id="global-frame" class="${self.pageClass()}">
    <%block name="header">
        <div class="navbar">
        <div class="navbar-inner">
        <div class="container">
            <a class="brand" href="${request.fwd_url("website_index")}">${g.project_name}</a>
            ${self.menu(vctxt.user)}
       </div>
       </div>
       </div>
        ${self.header_messages()}
    </%block>
    <%block name="contentwrapper">
        ${next.content()}
    </%block>
    <%block name="footer">
    <footer class="container">
        <div class="row">
        <div class="span12">
            <ul class="inline unstyled footer">
                <li>
                    <a href="#" class="footer-link">About</a>
                    <a href="#" class="footer-link">Jobs</a>
                    <a href="#" class="footer-link">Reviews</a>
                    <a href="#" class="footer-link">Help</a>
                    <a href="#" class="footer-link">Blog</a>
                    <a href="#" class="footer-link">Twitter</a>
                    <a href="#" class="footer-link">API Terms</a>
                </li>
            </ul>
        </div>
        </div>
    </footer>
    </%block>
</div>


<%def name="menu(user)">
    ${self.searchField()}
    <ul class="nav pull-right">
        <li class="nav-entry dropdown cart-dropdown-section">
            <a class="nav-entry-link" data-toggle="dropdown" href="${request.fwd_url("website_cart")}">
                <span class="cart-total total">${len(vctxt.cart.getItems())}</span>
                <span class="caret"></span>
            </a>
            <ul class="dropdown-menu">
                <li class="nav-entry cart-attach-dropdown"></li>
            </ul>
        </li>

    %if user.isAnon():

            <li class="dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" href="${request.fwd_url("website_login")}">
                    Login
                    <span class="caret"></span>
                </a>
                <span class="down-arrow"></span>
                <ul class="dropdown-menu">
                    <li>
                        <% form, values, errors = request.root.getLoginForm() %>
                        <form class="form form-validated" id="login-pull-down-form" method="post" action="${request.fwd_url("website_login")}">
                            <input type="hidden" name="type" value="${form.id}"/>
                            <input type="hidden" name="furl" value="${request.furl}"/>
                            <input type="hidden" name="token" value="${request.session.get_csrf_token()}"/>
                            %for field in form.fields:
                                ${field.render(form.id, request, values, errors, view)|n}
                            %endfor
                            <button type="submit" class="btn btn-primary">Login</button>
                            <a class="link js-link" hnc-loader="views/password">Forgot password</a>
                        </form>
                    </li>
                </ul>
            </li>
    %else:
        <li class="nav-entry">
            <a class="nav-entry-link" href="${request.fwd_url("website_logout")}">
                Logout
            </a>
        </li>
    %endif
    </ul>
</%def>


<%block name="layoutscripts"/>
<%def name="pageClass()"></%def>
<%def name="searchField()">
    <ul class="nav">
        <li class="nav-entry">
            <form action="${request.fwd_url("website_search")}">
                <div class="search-box">
                    <input type="text" name="l" class="search-query" placeholder="Search" value=""><button type="submit" class="btn"><span data-icon="s" aria-hidden="true"></span></button>
                    <a class="advanced-search-link" href="${request.fwd_url("website_search")}">Advanced Search</a>
                </div>
            </form>
        </li>
    </ul>
</%def>